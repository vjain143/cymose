swagger: '2.0'
info:
  description: This is a simple API
  version: 1.0.0
  title: Simple Mock API
  # put the contact info for your development or API team
  contact:
    email: vjain143@gmail.com

  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html

# tags are used for organizing operations
tags:
- name: Mock Fireeye iSight
  description: Mock Operations available to regular developers
- name: Mock Fireeye MAS
  description: Mock Operations available to regular developers

paths:
  /search/basic  :
    get:
      tags:
      - Mock Fireeye iSight
      summary: searches basic
      operationId: searchBasic
      description: | 
        By passing in the appropriate options, you can search for available intelligence report in the system for searched indicator.
      produces:
      - application/json
      - application/xml
      parameters:
      - in: query
        name: limit
        description: Limits the number of matching reports returned to the specified number. If not specified, the value defaults to 25. The limit and offset parameters can be used to retrieve paginated results.
        type: string
      - in: query
        name: offset
        description: The offset within the sorted results to start returning the results from. Must be paired with limit. If not specified, the value defaults to 0. The limit and offset parameters can be used to retrieve paginated results.
        type: string
      - in: query
        name: customerIntelOnly
        description: If true, only reports for the requesting user's organization are returned. If not specified, the value defaults to false.
        type: boolean
      - in: query
        name: startDate
        description: Limits the returned data to that published starting at this Epoch datetime. If not specified all reports within the user's subscribed date range will be searched.
        type: string
      - in: query
        name: endDate
        description: Limits the returned data to that published from a startDate and ending at this Epoch datetime. Must be paired with startDate. If not specified by default all reports within the user subscribed date range will be searched.
        type: string
      - in: query
        name: sortBy
        description: Indicates the report field and direction to sort the results by. Needs to be specifed as fieldname:asc OR fieldname:desc, where asc means ascending order and desc means descending order. The list of fields on which the sorting is supported are listed in sortBy fields.
        type: string
      
      responses:
        200:
          description: search results matching criteria
          schema:
              $ref: '#/definitions/IntelligenceReport'
          examples: 
            success: true
            message:
              - reportId: 14-31950
                title: 'Indicator Report: Sality Infrastructure Updates (July 19 to 25, 2014)'
                ThreatScape:
                  - Cyber Crime
                publishDate: 1406300710
                reportLink: 'https://api.isightpartners.com/report/14-31950'
                webLink: 'https://mysight.isightpartners.com/report/full/14-31950'
                matchedOn:
                  - key: ip
                    value: 66.34.253.56
              - reportId: 14-31407
                title: 'Indicator Report: Sality Infrastructure Updates (June 9 to 13, 2014)'
                ThreatScape:
                  - Cyber Crime
                publishDate: 1402925236
                reportLink: 'https://api.isightpartners.com/report/14-31407'
                webLink: 'https://mysight.isightpartners.com/report/full/14-31407'
                matchedOn:
                  - key: ip
                    value: 66.34.253.56
        400:
          description: bad input parameter
   
  /wsapis/v1.0.0/auth/login :
    post:
      tags:
      - Mock Fireeye MAS
      summary: authentication
      operationId: auth
      description: |
        By passing in the appropriate options, you can submit file for malware check.
      produces:
      - application/xml
      parameters: 
      - in: header
        name: Authorization
        type: string
      - in: header
        name: clientkey
        type: string
      responses:
        200:
          description: respond with submission key
          headers:
            apikey:
              type: string
              description: unique api key for calling entity
            clientkey:
              type: string
              description: unique key of calling client
            
        400:
          description: bad input parameter
        401:
          description: authentication refused
  
  /wsapis/v1.0.0/alerts  :
    get:
      tags:
      - Mock Fireeye MAS
      summary: searches alerts
      operationId: searchalerts
      description: | 
        By passing in the appropriate options, you can search for available intelligence report in the system for searched alerts data.
      produces:
      - application/json
      - application/xml
      parameters:
      - in: query
        name: duration
        description: ""
        type: string
      - in: query
        name: start_time
        description: ""
        type: string
      - in: query
        name: end_time
        description: ""
        type: string
      - in: query
        name: src_ip
        description: ""
        type: string
      - in: query
        name: dst_ip
        description: ""
        type: string
      - in: query
        name: malware_name
        description: ""
        type: string
      - in: query
        name: malware_type
        description: ""
        type: string
      - in: query
        name: sender_email
        description: ""
        type: string
      - in: query
        name: receiver_email
        description: ""
        type: string
      - in: query
        name: file_name
        description: ""
        type: string
      - in: query
        name: file_type
        description: ""
        type: string
      - in: query
        name: url
        description: ""
        type: string
      - in: query
        name: md5
        description: ""
        type: string
      - in: query
        name: callback_domain
        description: ""
        type: string
      - in: query
        name: info
        description: ""
        type: string
      responses:
        200:
          description: respond with submission key
          headers:
            apikey:
              type: string
              description: unique api key for calling entity
            clientkey:
              type: string
              description: unique key of calling client
          schema:
            $ref: '#/definitions/Alerts'
        400:
          description: bad input parameter
        401:
          description: authentication refused
          
  /wsapis/v1.0.0/submissions :
    post:
      tags:
      - Mock Fireeye MAS
      summary: Submit file
      operationId: submissions
      description: |
        By passing in the appropriate options, you can submit file for malware check.
      produces:
      - application/xml
      parameters: 
      - in: query
        name: analysistype
        description: ""
        type: string
      - in: query
        name: profile
        description: ""
        type: string
      - in: query
        name: application
        description: ""
        type: string
      - in: query
        name: priority
        description: "" 
        type: string
      - in: query
        name: force
        description: ""
        type: string
      - in: query
        name: prefetch
        description: ""
        type: string
      - in: query
        name: timeout
        description: ""
        type: string
      responses:
        200:
          description: respond with submission key
          schema:
            type: string
            example: "[{\"ID\".\"243_4\"}]"
        
        400:
          description: bad input parameter
  
  /wsapis/v1.0.0/submissions/status/{submissionkey} :
    post:
      tags:
      - Mock Fireeye MAS
      summary: Get status of file submitted file
      operationId: submissionsStatus
      description: |
        By passing in the appropriate options, you can get status of submitted file for malware check.
      produces:
      - application/xml
      parameters: 
      - in: path
        name: submissionkey
        description: ""
        type: string
        required: true
      responses:
        200:
          description: respond with status key
          schema:
            type: string
            description: Submission Status
            enum:
            - Submission not found
            - In Progress
            - Done
            example: "Done"
        400:
          description: bad input parameter

  /wsapis/v1.0.0/submissions/results/{submissionkey} :
    post:
      tags:
      - Mock Fireeye MAS
      summary: Get result of file submitted file
      operationId: submissionsResult
      description: |
        By passing in the appropriate options, you can get status of submitted file for malware check.
      produces:
      - application/json
      - application/xml
      parameters: 
      - in: path
        name: submissionkey
        description: ""
        type: string
        required: true
      responses:
        200:
          description: respond with alert result data
          schema:
            $ref: '#/definitions/Alerts'
        400:
          description: bad input parameter
          
# Added definitions of the Object
definitions:
# Added Intelligence Report Object
  IntelligenceReport:
    type: object
    required:
    - reportId
    properties:
      success:
        type: boolean
      message:
        type : array
        items: 
          $ref: '#/definitions/Message'
# Added Message Object  
  Message:
    type : object
    properties:
      reportId:
        type: string
        example: "14-31950"
      title: 
        type: string
        example : "Indicator Report: Sality Infrastructure Updates (July 19 to 25, 2014)"
      ThreatScape:
        type: array
        items: 
          type: string 
        example: [Cyber Crime]
      publishDate:
        type: string
        example : 1406300710
      reportLink: 
        type: string
        example: "https://api.isightpartners.com/report/14-31950"
      webLink: 
        type: string
        example: "https://mysight.isightpartners.com/report/full/14-31950"
      matchedOn:
        type: array
        items:
           $ref: '#/definitions/Map'  
# Added MAP Object           
  Map:
    type: object
    properties:
      key:
        type: string
        example: "ip"
      value:
        type: string
        example: "66.34.253.56"

# Added Alerts Object
  Alerts:
    type: object
    properties:
      alerts:
        type: object
        properties:
          alert:
            type: object
            properties:
              explanation:
                type: object
                properties:
                  malware-detected:
                    type: object
                    properties:
                      malware:
                        type: object
                        properties:
                          downloaded-at: 
                            type: string
                            example : "2013-10-25T18:07:22Z"
                          md5sum:
                            type: string
                            example: "dcccec58a8979c5a3949c82a79267250"
                          original:
                            type: string
                            example: "VoiceMail_Houston_(713)4582949.zip"
                          http-header: 
                            type: string 
                            example: "GET /malware/VoiceMail_Houston_(713)4582949.zip HTTP/1.0\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\nAccept: */*\nHost: xabean.com\nConnection: Keep-Alive\n\nHTTP/1.1 200 OK\nDate: Fri, 25 Oct 2013 18:07:21 GMT\nServer: TI-99/4A (Unix)\nLast-Modified: Fri, 25 Oct 2013 18:06:06 GMT\nETag: \"361c23-14d75-526ab30e\"\nAccept-Ranges: bytes\nContent-Length: 85365\nContent-Type: application/zip\nConnection: close\nAge: 0"
                          profile: 
                            type: string
                            example: "win7-sp1"
                          executed-at: 
                            type: string
                            example: "2013-10-25T18:09:26Z"
                          application: 
                            type: string
                            example: "explorer"
                          _name: 
                            type: string
                            example: "Malware.archive"
                          _stype: 
                            type: string
                            example: "archive"
                          _type:
                            type: string
                            example: "zip"
                  _analysis:
                    type: string
                    example: "content"
                  _protocol: 
                    type: string
                    example: "tcp"    
              src:
                type: object
                properties:
                  ip:
                    type: string
                    example: "10.10.20.30"
                  host: 
                    type: string
                    example: "malware.sandbox.example.com"
                  port: 
                    type: string
                    example: "50130"
                  _vlan: 
                    type: string
                    example: "900"
              dst:
                type: object
                properties:
                  ip:
                    type: string
                    example : "222.222.222.222"
                  port: 
                    type: string
                    example : "80"
              occurred: 
                type: string
                example : "2013-10-25T18:09:25Z"
              alert-url: 
                type: string
                example : "https://fireeye.example.com/event_stream/events_for_bot?ma_id=1694304"
              action: 
                type: string
                example: "notified"
              _id: 
                type: string
                example: "1694304"
              _name: 
                type: string
                example: "malware-object"
              _severity: 
                type: string
                example: "majr"    
                
# Added by API Auto Mocking Plugin
host: virtserver.swaggerhub.com
# basePath: /vjain1435/cymose/1.0.0
schemes:
 - https
# Added by API Auto Mocking Plugin
basePath: /vjain1430/cymose/1.0.0